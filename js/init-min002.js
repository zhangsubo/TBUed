KISSY.add("utils/promot",function(a){var b=a.Node.all,c={cfg:{timeout:2e3},_render:function(){var a=this,c=b('<div class="com-promot"><div class="display-area"></div></div>');b("body").append(c),a.root=c},show:function(a,b){var c=this;c.root?"":c._render(),b=b||c.cfg.timeout,c.timer?clearTimeout(c.timer):"",c.root.removeClass("status-smaller"),c.root.children(".display-area").html(a),c.root.show(),-1!=b&&(c.timer=setTimeout(function(){c.hide(!0)},b))},hide:function(a){var b=this;a?(b.root.addClass("status-smaller"),b.timer=setTimeout(function(){b.root.hide(),b.root.removeClass("status-smaller")},600)):(b.root.hide(),b.root.removeClass("status-smaller"))}};return c},{requires:["core"]}),KISSY.add("utils/tool",function(a,b){function c(){return"webkitTransition"in document.body.style||"MozTransition"in document.body.style||"msTransition"in document.body.style||"oTransition"in document.body.style}function d(){return a.UA.ie&&a.UA.ie<7?!0:!1}function e(){return a.UA.mobile?!0:!1}function f(){return a.UA.ipad?!0:!1}function g(){return a.UA.ios?!0:!1}function h(){return a.UA.android?!0:!1}var i=a.Node.all,j={isCSS3Support:c(),isMobile:e(),isAndroid:h(),isIos:g(),isIpad:f(),isIE6:d(),initCxt:function(){var a=this,b=i("html");a.isCSS3Support?b.addClass("ks-css3"):b.addClass("ks-not-css3"),a.isMobile&&b.addClass("ks-mobile")},browserUpdate:function(){var a=this;a.isIE6&&alert("\u6dd8\u5b9dUED\u535a\u5ba2\u5e76\u672a\u9488\u5bf9\u4f4e\u7248\u672c\u6d4f\u89c8\u5668\u505a\u517c\u5bb9\uff0c\u4e3a\u4e86\u66f4\u597d\u7684\u4f53\u9a8c\uff0c\u8bf7\u5347\u7ea7\u60a8\u7684\u6d4f\u89c8\u5668\uff01")},validate:function(b,c){var d=this,e=a.trim(b.val()),f=b.attr("data-null"),g=b.attr("data-rule"),h=b.attr("data-error");if(!e&&f)return b.addClass("error"),c&&d.promot(f),b.fire("focus"),!1;var i=new RegExp(g,"g");return g&&!i.test(e)&&h?(b.addClass("error"),c&&d.promot(h),b.fire("focus"),!1):(b.removeClass("error"),!0)},promot:function(a){var c=this;c.isCSS3Support?b.show(a):alert(a)},init:function(){var a=this;a.browserUpdate(),a.initCxt()}};window.UED=window.UED||{},window.UED=a.merge(window.UED,j),window.UED.init()},{requires:["utils/promot","core"]}),KISSY.add("public/page/mods/main",function(a,b){function c(){var a=this;a.init()}var d=a.Node.all,e="like-posts";return c.prototype={isInit:null,navNode:null,labelNode:null,backTopNode:null,loginNode:null,init:function(){var a=this;a.initCxt(),a.watchWindow(),a.addEvent(),a.dropDownNav(),a.initLikedPosts(),a.initQRCode()},initCxt:function(){var a=this;a.isInit=!1,a.navNode=d("#J_Nav"),a.labelNode=d("#J_NavLabel"),a.backTopNode=d("#J_BackTop"),a.loginNode=d("#J_Login"),a.navMenuNode=d("#menu-primary"),a.curMenuItemNode=d(".current-menu-item")},initQRCode:function(){new b("J_QRWrapper",{text:window.location.href,width:150,height:150,colorDark:"#666666",colorLight:"#ffffff",correctLevel:b.CorrectLevel.H})},getLikedPosts:function(){var b=a.Cookie.get(e);return b?postArr=b.split("@"):null},setLikedPost:function(b){var c=a.Cookie.get(e),d="@"+b+"@";return a.isUndefined(c)?(a.Cookie.set(e,d,365),void 0):(-1==c.indexOf(d)&&(c+=b+"@"),a.Cookie.set(e,c,365),void 0)},initLikedPosts:function(){var a=this,b=a.getLikedPosts();if(b)for(var c=0;c<b.length;c++)if(!isNaN(parseInt(b[c]))){var e=d(".post-"+b[c]);e.length&&e.all(".like").addClass("liked")}a.isInit=!0},menuHover:function(b){var c=this;if(b){var d=c.navMenuNode.offset().top,e=b.offset().top-d;"none"==c.labelNode.css("display")?c.labelNode.css("top",e).show():(a.Anim.stop(c.labelNode,!1,!1,"topAnim"),new a.Anim(c.labelNode,{top:e},{duration:.2,easing:"ease-out",queue:"topAnim",useTransition:!0}).run())}else c.labelNode.fadeOut(.3)},resetLabel:function(){var b=this,c=b.navMenuNode.offset().top;if(a.Anim.stop(b.labelNode,!0,!1,"topAnim"),b.curMenuItemNode.length){var d=b.curMenuItemNode.offset().top-c;b.labelNode.css("top",d).fadeIn(.3)}else b.labelNode.fadeOut(.3)},dropDownNav:function(){var b=this,c=parseInt(b.navNode.css("top"));d("body").hasClass("home")?c>0?(b.navNode.show(),b.resetLabel()):(b.navNode.css("top","-500px").show(),new a.Anim(b.navNode,{top:parseInt(d("body").offset().top)},{duration:1,easing:"easeOutStrong",queue:"topAnim",complete:function(){b.resetLabel()}}).run()):b.resetLabel()},windowChangeCB:function(){var b=this,c=document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop;if(c>500?b.backTopNode.fadeIn(.3):b.backTopNode.fadeOut(.3),!window.UED.isMobile){var e=b.navNode.outerHeight(),f=d("#content").outerHeight(),g=f-e-100;c>=g?(b.navNode.addClass("nav-abs"),a.Anim.stop(b.navNode,!0,!1,"topAnim"),g=0>g?0:g,b.navNode.css("top",g)):(b.navNode.removeClass("nav-abs"),b.navNode.css("top","auto"))}},watchWindow:function(){var a=this;d(window).on("scroll",function(){a.windowChangeCB()}),d(window).on("resize",function(){setTimeout(function(){a.windowChangeCB()},100)}),a.windowChangeCB()},animShow:function(a,b){if(window.UED.isCSS3Support){var c=a[0];c.timer&&clearTimeout(c.timer),a.show(),c.timer=setTimeout(function(){a.addClass(b)},10)}else a.addClass(b)},animHide:function(a,b,c){if(window.UED.isCSS3Support){var d=a[0];d.timer&&clearTimeout(d.timer),a.removeClass(b),d.timer=setTimeout(function(){a.hide()},c)}else a.removeClass(b)},addEvent:function(){var b=this;d("#J_QR").on("mouseover mouseleave",function(a){var c=d("#J_QRContent");"mouseover"==a.type?b.animShow(c,"show"):b.animHide(c,"show",200)});var c=b.loginNode.all(".J_LoginEntry");c.length&&(c.on("click",function(a){a.stopPropagation();var c=b.loginNode.all(".J_FormWrapper");c.hasClass("show")?b.animHide(c,"show",200):b.animShow(c,"show")}),d("body").on("mousedown",function(a){if(!d(a.target).parent("#J_Login")){var c=b.loginNode.all(".J_FormWrapper");b.animHide(c,"show",200)}})),window.UED.isMobile?b.backTopNode.all("a").on("tap",function(){window.scrollTo(window.scrollX,0)}):(b.navMenuNode.all("li").on("mouseover",function(a){a.stopPropagation(),b.menuHover(d(this))}),b.navMenuNode.on("mouseleave",function(){b.menuHover(b.navNode.one(".current-menu-item"))}),b.backTopNode.all("a").on("click",function(){return new a.Anim(window,{scrollTop:0},{duration:1,easing:"easeOutStrong",queue:"scrollTopAnim"}).run(),!1})),d("#J_MoreLink").on("click",function(){var a=d(this),b=d("#J_LinksWrapper");b.hasClass("closed")?(a.html("^^"),b.removeClass("closed")):(a.html("MORE..."),b.addClass("closed"))}),d(".post").all(".like").on("click",function(){var a=d(this);b.likePost(a)})},likePost:function(b){var c=this;if(!c.isInit)return window.UED.promot("\u6b63\u5728\u521d\u59cb\u5316\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5\uff01"),!1;if(b.hasClass("liked")||b.hasClass("liking"))return!1;b.addClass("liking");var e=b.parent(".post").attr("data-id"),f=d("#J_Home").val(),g={action:"likePost",postId:e};return a.io({url:f,type:"GET",data:g,timeout:10,dataType:"json",success:function(a){if(a.status){c.setLikedPost(a.postId),b.removeClass("liking").addClass("liked");var d=b.one("em");d?d.html(a.likeCount):b.html(a.likeCount)}else b.removeClass("liking"),window.UED.promot(a.msg)},error:function(){b.removeClass("liking"),window.UED.promot("\u64cd\u4f5c\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5\uff01")}}),!1}},c},{requires:["gallery/qrcode/1.0/","core","utils/tool"]}),KISSY.config({combine:!0,packages:{"public":{base:"./wp-content/themes/taobaoued/assets/build/pages/public/",charset:"utf-8"}}}),KISSY.add("public/page/init",function(a,b){a.ready(function(){new b})},{requires:["./mods/main"]}),KISSY.use("public/page/init");